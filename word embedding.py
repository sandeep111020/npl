
Word Embedding Techniques using Embedding Layer in Keras
In [39]:
### Libraries USed Tensorflow> 2.0  and keras
In [ ]:

In [2]:
##tensorflow >2.0
from tensorflow.keras.preprocessing.text import one_hot
In [3]:
### sentences
sent=[  'the glass of milk',
     'the glass of juice',
     'the cup of tea',
    'I am a good boy',
     'I am a good developer',
     'understand the meaning of words',
     'your videos are good',]
In [4]:
sent
Out[4]:
['the glass of milk',
 'the glass of juice',
 'the cup of tea',
 'I am a good boy',
 'I am a good developer',
 'understand the meaning of words',
 'your videos are good']
In [31]:
### Vocabulary size
voc_size=10000
One Hot Representation
In [32]:
onehot_repr=[one_hot(words,voc_size)for words in sent] 
print(onehot_repr)
[[6654, 998, 8966, 1609], [6654, 998, 8966, 1428], [6654, 4519, 8966, 4736], [8807, 9358, 6927, 7257, 6349], [8807, 9358, 6927, 7257, 801], [5774, 6654, 257, 8966, 4241], [4044, 1506, 8798, 7257]]
Word Embedding Represntation
In [9]:
from tensorflow.keras.layers import Embedding
from tensorflow.keras.preprocessing.sequence import pad_sequences
from tensorflow.keras.models import Sequential
In [10]:
import numpy as np
In [33]:
sent_length=8
embedded_docs=pad_sequences(onehot_repr,padding='pre',maxlen=sent_length)
print(embedded_docs)
[[   0    0    0    0 6654  998 8966 1609]
 [   0    0    0    0 6654  998 8966 1428]
 [   0    0    0    0 6654 4519 8966 4736]
 [   0    0    0 8807 9358 6927 7257 6349]
 [   0    0    0 8807 9358 6927 7257  801]
 [   0    0    0 5774 6654  257 8966 4241]
 [   0    0    0    0 4044 1506 8798 7257]]
In [13]:
dim=10
In [40]:
model=Sequential()
model.add(Embedding(voc_size,10,input_length=sent_length))
model.compile('adam','mse')
In [35]:
model.summary()
Model: "sequential_10"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 8, 10)             100000    
=================================================================
Total params: 100,000
Trainable params: 100,000
Non-trainable params: 0
_________________________________________________________________
In [41]:
print(model.predict(embedded_docs))
[[[-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-3.78632322e-02 -2.62806062e-02  2.97411121e-02 -3.30717117e-02
    2.71405019e-02  9.45134088e-03  2.37812735e-02  4.17690389e-02
    5.14941290e-03  1.52081959e-02]
  [ 4.83418591e-02  4.38831113e-02 -2.80225277e-02 -1.47548690e-02
   -1.21230260e-02  3.76243480e-02 -1.16624944e-02 -2.14108825e-02
    4.65453304e-02  1.53732188e-02]
  [ 3.27601545e-02 -6.37691095e-03  3.90734412e-02 -1.91246755e-02
    2.17718594e-02 -4.63032499e-02  8.00942257e-03 -3.11566722e-02
   -4.86455113e-03 -4.84352373e-02]
  [-4.17361744e-02  3.43806408e-02  2.88052075e-02 -1.89645533e-02
    3.23303007e-02 -1.09453127e-03 -1.67517066e-02 -9.41916555e-03
   -3.30929384e-02 -4.77949157e-02]]

 [[-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-3.78632322e-02 -2.62806062e-02  2.97411121e-02 -3.30717117e-02
    2.71405019e-02  9.45134088e-03  2.37812735e-02  4.17690389e-02
    5.14941290e-03  1.52081959e-02]
  [ 4.83418591e-02  4.38831113e-02 -2.80225277e-02 -1.47548690e-02
   -1.21230260e-02  3.76243480e-02 -1.16624944e-02 -2.14108825e-02
    4.65453304e-02  1.53732188e-02]
  [ 3.27601545e-02 -6.37691095e-03  3.90734412e-02 -1.91246755e-02
    2.17718594e-02 -4.63032499e-02  8.00942257e-03 -3.11566722e-02
   -4.86455113e-03 -4.84352373e-02]
  [ 2.47278921e-02 -1.74773335e-02  2.73607112e-02  3.32159512e-02
    3.40201892e-02  3.07315923e-02  3.27118374e-02  2.95767300e-02
    3.36540863e-03 -1.39380470e-02]]

 [[-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-3.78632322e-02 -2.62806062e-02  2.97411121e-02 -3.30717117e-02
    2.71405019e-02  9.45134088e-03  2.37812735e-02  4.17690389e-02
    5.14941290e-03  1.52081959e-02]
  [-3.94934304e-02  3.93595435e-02 -1.15531087e-02  1.84574835e-02
   -1.24117024e-02  2.67759599e-02  3.72202061e-02  2.54639238e-03
   -1.26881972e-02  1.82384253e-03]
  [ 3.27601545e-02 -6.37691095e-03  3.90734412e-02 -1.91246755e-02
    2.17718594e-02 -4.63032499e-02  8.00942257e-03 -3.11566722e-02
   -4.86455113e-03 -4.84352373e-02]
  [ 2.06373222e-02 -4.02337313e-02 -7.88780302e-03  4.99007814e-02
    6.30392879e-03 -4.51510027e-03 -4.75921407e-02  4.11981009e-02
    2.95249373e-03 -2.82982830e-02]]

 [[-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-1.45982131e-02  3.89718898e-02  8.12438875e-03  2.98856981e-02
   -4.28516045e-02  3.53246070e-02  4.52651493e-02  4.48638909e-02
    8.75295326e-03  7.60734081e-04]
  [ 4.34498824e-02 -1.39420740e-02 -3.63176242e-02  1.51205100e-02
   -5.29961661e-03  3.06736305e-03  2.74117328e-02 -5.53436205e-03
    1.96599998e-02  2.70034112e-02]
  [ 3.74776237e-02  1.71419419e-02  8.23931769e-03  1.07321031e-02
   -3.70843410e-02 -4.27805260e-03  1.64627098e-02  4.67015617e-02
    1.75209157e-02 -1.24720335e-02]
  [ 4.71589826e-02 -1.86485425e-02  4.58842032e-02  2.64571793e-02
   -3.14603336e-02  1.91541426e-02 -3.84818092e-02 -3.24337035e-02
   -2.62893792e-02 -3.42335850e-02]
  [ 1.76342018e-02  4.38630097e-02 -4.35516834e-02 -3.61544117e-02
   -1.39240138e-02 -3.95030975e-02 -3.59680876e-02  2.06494816e-02
   -1.58333890e-02 -4.47947755e-02]]

 [[-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-1.45982131e-02  3.89718898e-02  8.12438875e-03  2.98856981e-02
   -4.28516045e-02  3.53246070e-02  4.52651493e-02  4.48638909e-02
    8.75295326e-03  7.60734081e-04]
  [ 4.34498824e-02 -1.39420740e-02 -3.63176242e-02  1.51205100e-02
   -5.29961661e-03  3.06736305e-03  2.74117328e-02 -5.53436205e-03
    1.96599998e-02  2.70034112e-02]
  [ 3.74776237e-02  1.71419419e-02  8.23931769e-03  1.07321031e-02
   -3.70843410e-02 -4.27805260e-03  1.64627098e-02  4.67015617e-02
    1.75209157e-02 -1.24720335e-02]
  [ 4.71589826e-02 -1.86485425e-02  4.58842032e-02  2.64571793e-02
   -3.14603336e-02  1.91541426e-02 -3.84818092e-02 -3.24337035e-02
   -2.62893792e-02 -3.42335850e-02]
  [ 3.44808139e-02 -3.24114189e-02 -4.27851342e-02 -2.97762640e-02
    2.60863453e-03  1.32247098e-02 -1.52253993e-02 -1.80003159e-02
    2.13337280e-02  1.47879384e-02]]

 [[-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [ 2.63044573e-02  2.80261897e-02  1.40655302e-02 -4.43899632e-02
    1.81863420e-02 -1.36698112e-02 -1.56870857e-02  3.44555862e-02
   -3.74745578e-04 -1.69391036e-02]
  [-3.78632322e-02 -2.62806062e-02  2.97411121e-02 -3.30717117e-02
    2.71405019e-02  9.45134088e-03  2.37812735e-02  4.17690389e-02
    5.14941290e-03  1.52081959e-02]
  [-8.33611563e-03  2.41871588e-02 -3.85412946e-02  1.45175718e-02
   -2.90340185e-03  1.33649968e-02 -1.90682653e-02 -1.13456734e-02
   -2.53981706e-02 -5.07142395e-03]
  [ 3.27601545e-02 -6.37691095e-03  3.90734412e-02 -1.91246755e-02
    2.17718594e-02 -4.63032499e-02  8.00942257e-03 -3.11566722e-02
   -4.86455113e-03 -4.84352373e-02]
  [-5.03426790e-03  3.16982381e-02 -3.33745480e-02  9.92731005e-03
   -2.68347152e-02  3.51600312e-02  9.41620022e-03  1.34210698e-02
   -3.88347134e-02 -3.49127762e-02]]

 [[-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.25554439e-03 -1.59294531e-03 -4.71415296e-02  4.42524664e-02
   -9.73954052e-03 -4.32581306e-02  4.00710814e-02 -1.43285990e-02
   -3.65974903e-02 -2.37902757e-02]
  [-4.73472364e-02 -3.81088741e-02 -2.09466461e-02 -2.04950571e-02
    1.39485039e-02  4.69478406e-02  1.68476589e-02 -3.53824347e-04
   -4.28333394e-02 -3.28581110e-02]
  [-1.94661859e-02 -2.65732538e-02  1.35865100e-02  3.72302271e-02
   -6.92135096e-03  3.96609344e-02 -2.66522169e-02  4.32638861e-02
    4.62255217e-02  3.84382121e-02]
  [ 2.43262388e-02 -3.90543789e-03 -3.17700654e-02  2.07458772e-02
    1.68472528e-03  3.81677859e-02 -2.90758908e-05  2.38945819e-02
   -4.55065966e-02 -4.36516404e-02]
  [ 4.71589826e-02 -1.86485425e-02  4.58842032e-02  2.64571793e-02
   -3.14603336e-02  1.91541426e-02 -3.84818092e-02 -3.24337035e-02
   -2.62893792e-02 -3.42335850e-02]]]
In [37]:
embedded_docs[0]
Out[37]:
array([   0,    0,    0,    0, 6654,  998, 8966, 1609])
In [42]:
print(model.predict(embedded_docs)[0])
[[-0.00425554 -0.00159295 -0.04714153  0.04425247 -0.00973954 -0.04325813
   0.04007108 -0.0143286  -0.03659749 -0.02379028]
 [-0.00425554 -0.00159295 -0.04714153  0.04425247 -0.00973954 -0.04325813
   0.04007108 -0.0143286  -0.03659749 -0.02379028]
 [-0.00425554 -0.00159295 -0.04714153  0.04425247 -0.00973954 -0.04325813
   0.04007108 -0.0143286  -0.03659749 -0.02379028]
 [-0.00425554 -0.00159295 -0.04714153  0.04425247 -0.00973954 -0.04325813
   0.04007108 -0.0143286  -0.03659749 -0.02379028]
 [-0.03786323 -0.02628061  0.02974111 -0.03307171  0.0271405   0.00945134
   0.02378127  0.04176904  0.00514941  0.0152082 ]
 [ 0.04834186  0.04388311 -0.02802253 -0.01475487 -0.01212303  0.03762435
  -0.01166249 -0.02141088  0.04654533  0.01537322]
 [ 0.03276015 -0.00637691  0.03907344 -0.01912468  0.02177186 -0.04630325
   0.00800942 -0.03115667 -0.00486455 -0.04843524]
 [-0.04173617  0.03438064  0.02880521 -0.01896455  0.0323303  -0.00109453
  -0.01675171 -0.00941917 -0.03309294 -0.04779492]]
